# Frequently Asked Questions

## General Questions

### What is Kratix?

Kratix is a framework for building platforms. It enables platform teams to create Promises (self-service APIs) that application teams can use to request resources like databases, message queues, or entire development environments.

### What does this project provide?

This project provides automated scripts to set up a local Kratix environment using Kind (Kubernetes in Docker). It creates:
- A **platform cluster** where Kratix runs
- A **worker cluster** where workloads are deployed
- All necessary components (MinIO, Flux, etc.) pre-configured

### Why use Kind instead of a real Kubernetes cluster?

Kind is ideal for:
- Local development and testing
- Learning Kratix without cloud costs
- CI/CD pipelines
- Quick experimentation with Promises

For production, you would use managed Kubernetes services or on-premise clusters.

## Architecture Questions

### What is the difference between the platform and worker clusters?

- **Platform Cluster**: Runs Kratix and stores Promise definitions. This is where platform teams define what services are available.
- **Worker Cluster**: Where actual workloads run. When users request resources through Promises, the resulting applications are deployed here.

### Why do I need two clusters?

The two-cluster architecture separates concerns:
- Platform operators manage the platform cluster
- Application teams consume resources that appear on worker clusters
- This mirrors real-world enterprise setups where platform and workload infrastructure are separate

You can also run Kratix with a single cluster or multiple workers.

### What is MinIO used for?

MinIO is an S3-compatible object store used as the "state store" for Kratix. It holds:
- Manifests generated by Promise pipelines
- Configuration that Flux reads to deploy to workers

In production, you might use AWS S3, Google Cloud Storage, or a Git repository instead.

### What is Flux and why is it needed?

Flux is a GitOps tool that watches the MinIO bucket and applies changes to the worker cluster. It provides:
- Automatic synchronization of resources
- Reconciliation if resources drift from desired state
- Clear audit trail of what's deployed

## Usage Questions

### How do I add more worker clusters?

Create additional Kind clusters and register them as Destinations:

```bash
# Create another worker
kind create cluster --name worker-2

# Install Flux on the new worker
# Configure Flux to watch MinIO
# Register as a new Destination on the platform cluster
```

See the [Kratix documentation](https://docs.kratix.io) for detailed multi-cluster setup.

### Can I use existing clusters instead of creating new ones?

Yes, you can adapt the scripts to use existing clusters. The key steps are:
1. Install cert-manager and Kratix on your platform cluster
2. Install Flux on your worker cluster(s)
3. Configure the state store and destinations

### How do I access services deployed on the worker?

Use port-forwarding:

```bash
kubectl --context $WORKER port-forward svc/<service-name> <local-port>:<service-port>
```

For example, to access Jenkins:

```bash
kubectl --context $WORKER port-forward svc/jenkins-operator-http-dev-example 8080:8080
```

### How do I view MinIO contents?

The Kratix MinIO installation only exposes the S3 API, not the web console. Use the MinIO Client (`mc`) to browse contents.

First, install mc:

```bash
# macOS
brew install minio/stable/mc

# Linux
wget https://dl.min.io/client/mc/release/linux-amd64/mc
chmod +x mc
sudo mv mc /usr/local/bin/
```

Then port-forward and configure mc:

```bash
# Start port-forward (run in background or separate terminal)
kubectl --context $PLATFORM port-forward -n kratix-platform-system svc/minio 9000:80 &

# Get credentials
ACCESS_KEY=$(kubectl --context $PLATFORM get secret minio-credentials -n default -o jsonpath='{.data.accessKeyID}' | base64 -d)
SECRET_KEY=$(kubectl --context $PLATFORM get secret minio-credentials -n default -o jsonpath='{.data.secretAccessKey}' | base64 -d)

# Configure mc alias
mc alias set kratix http://localhost:9000 "$ACCESS_KEY" "$SECRET_KEY"

# List buckets
mc ls kratix

# List bucket contents
mc ls kratix/kratix

# View a specific file
mc cat kratix/kratix/path/to/file.yaml
```

## Resource Management Questions

### How much resources do the clusters use?

Each Kind cluster uses approximately:
- 500MB-1GB RAM at idle
- More when running workloads

Recommended minimums:
- 4GB RAM allocated to Docker
- 2 CPUs

### Can I stop the clusters without deleting them?

Yes, use the shutdown script to stop clusters and preserve state:

```bash
./shutdown-kratix-kind.sh
```

Restart with:

```bash
./startup-kratix-kind.sh
```

### How do I completely remove everything?

Run the teardown script:

```bash
./teardown-kratix-kind.sh
```

This deletes both Kind clusters and all associated resources.

## Troubleshooting Questions

### Why are my Promises not deploying to the worker?

Common causes:
1. Flux isn't syncing - check Flux logs
2. MinIO connectivity issues - verify bucket source status
3. Pipeline failures - check job logs

See [Troubleshooting](troubleshooting.md) for detailed solutions.

### Can I use this on Windows?

These scripts are designed for macOS and Linux. On Windows, you can:
- Use WSL2 (Windows Subsystem for Linux)
- Run the commands manually in PowerShell (with modifications)

### Where can I get more help?

- [Kratix Documentation](https://docs.kratix.io)
- [Kratix GitHub](https://github.com/syntasso/kratix)
- [Kratix Slack](https://kratix.io/slack)
- [Kind Documentation](https://kind.sigs.k8s.io)